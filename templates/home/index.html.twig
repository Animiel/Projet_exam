{% extends 'base.html.twig' %}

{% block title %}PetSeek | Acceuil{% endblock %}

{% block body %}

    <h1>Bienvenue sur <strong class="app-name">Pet'Seek</strong> !</h1>

    <p>
        Ce site est conçu pour les personnes ayant perdu leurs animaux domestiques et/ou voulant converser sur nos amis les bêtes.<br>
        Pour avoir un plan détaillé du site 
        <a href="" class="text-link">cliquez ici</a>.<br>
        Pour avoir un rappel sur les menaces du web 
        <a href="" class="text-link">c'est par là</a>.
    </p>
    <p>
        En espérant que ce site pourra vous aider, vous instruire et vous divertir !
    </p>
    <p>
        Sur cette page vous pourrez trouver les annonces des personnes ayant perdu leur petit compagnon.<br>
        Pour interagir avec une annonce vous <strong>devez être inscrit(e) et connecté(e)</strong>, et cliquer sur l'action souhaitée :<br>
        <ul>
            <li>Ajouter aux favoris : en fonction de vos chances d'avoir des informations au sujet de l'animal.</li>
            <li>Envoyer un message au propriétaire : si vous avez déjà une information.</li>
        </ul>
    </p>

    <h2>Les avis de recherche...</h2>
    
    {% if app.user %}
        <a href="{{ path('create_annonce') }}">Nouvelle annonce</a>
    {% endif %}

    {# on crée une grille d'avis de recherches #}
    <div id="grid">
        {% for annonce in annonces %}

            {# on affiche un avis de recherche... #}
            <div class="wanted">
                {# ...avec l'image correspondante #}
                <img src="{{ asset('/img/annonces/' ~ annonce.image ~ '') }}" class="wanted-pic">
                {# si un utilisateur est connecté, il a la possibilité d'ajouter les annonces en favoris #}
                {% if app.user %}
                    {% if annonce in app.user.annonceFavorites %}
                        <a href="{{ path('remove_afav', {'id': annonce.id }) }}">
                            <i class="fa-solid fa-heart" style="color: #d747cb;"></i>
                        </a>
                    {% else %}
                        <a href="{{ path('add_afav', {'id': annonce.id }) }}">
                            <i class="fa-regular fa-heart" style="color: #d747cb;"></i>
                        </a>
                    {% endif %}
                {% else %}
                    <p>Vous devez être connecté pour ajouter cette annonce à vos favoris.</p>
                {% endif %}

                {# ...on affiche les infos écrites #}
                <h3>Signes distinctifs</h3>

                <ul>
                    <li>
                        {{ annonce.infoUne }}
                    </li>
                    {% if annonce.infoDeux %}
                        <li>
                            {{ annonce.infoDeux }}
                        </li>
                    {% endif %}
                    {% if annonce.infoTrois %}
                        <li>
                            {{ annonce.infoTrois }}
                        </li>
                    {% endif %}
                </ul>

                {# on peut notifier un annonceur lorsqu'on est connecté #}
                {% if app.user %}
                    <a href="{{ path('notif_annonce', {'id': annonce.annonceUser.id }) }}">J'ai une info !</a>
                {% else %}
                    <p></p>
                {% endif %}

                {# lien uniquement pour le créateur de l'annonce ou pour les admins #}
                {% if app.user and (is_granted('ROLE_ADMIN') or app.user.id == annonce.annonceUser.id) %}
                    <a href="{{ path('suppr_annonce', {'id': annonce.id }) }}">Supprimer l'annonce</a><br>
                {% endif %}

                {# fonction réservée aux admins #}
                {% if is_granted('ROLE_ADMIN') %}
                    <a href="{{ path('ban_user', {'id': annonce.annonceUser.id }) }}">Bannir l'utilisateur</a>
                {% endif %}
            </div>
        {% endfor %}
    </div>
{% endblock %}
